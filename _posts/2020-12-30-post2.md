---
layout: post
title:  "2.CALDERA 설치 하기"
date:   2020-12-30
categories: jekyll update
---
### [https://caldera.readthedocs.io/en/latest/](https://caldera.readthedocs.io/en/latest/) 해당 글은 이 글을 바탕으로 작성되었음을 알립니다.

[Caldera 2.6.2 tutorial](https://www.youtube.com/watch?v=_mVGjqu03fg)
이 영상이 github에 올라가 있길래 이걸 먼저 따라 해 보기로 했다.

그런데.. 이 영상은 2월에 작성되었고 지금은 12월이다.
그래서 그런지 UI가 조금 달랐다.
그래도 핵심 원리는 바뀔 리가 없기에 감안하고 시청했다.

Caldera는 알다시피 APT 시뮬레이터의 일종이다.
APT 시뮬레이터란 간단하게 말하자면 어차피 완벽한 시스템은 없기 때문에 뚫리는 걸 감안하고 '어차피 뚫릴 거라면 어떻게 뚫릴까?'를 예상하는 시뮬레이션이다. 그럼 그에 대한 취약점을 보완 할 수 있고 이 시뮬레이션을 반복 할 수록 사이버 공격을 당할 확률을 줄일 수 있다.

내가 몇 일동안 삽질을 해 본 결과를 요약하자면 다음과 같다.

1. 일단 계정은 red랑 blue도 있는데, blue팀은 내 관할이 아니다.
2. Red팀은 사이버 공격을 시도할 요원을 생성 할 수 있다.
3. 에이전트에게 능력을 부여 할 수 있다.
4. 해당 에이전트가 작전을 수행 한 후 보고서를 만든다.

![기본구조](/img/2_1.PNG)

이게 가장 기본적인 구조이다.
왼쪽 상단의 네비게이션바를 누르면 맨 처음 나온다.
agents -> adversaries -> operations 순으로 알아보겠다.
agents를 누른다.

![agents](/img/2_2.PNG)

그럼 이런 화면을 찾을 수 있다.
저기서 주황색 버튼 Click here to deploy an agent 를 눌러준다.

![deploy](/img/2_3.PNG)

여기서 부터 설명을 하자면, 54nc47은 Sandcat이라는 이름을 가진 Agent다.
기본적인 HTTP 프로토콜을 이용하는 Agent인데, Go 언어로 만들어져 있다.
자꾸 영어로 쓰니까 어려워서 지금 부턴 그냥 에이전트라고 부르겠다.

에이전트란 설치가 필요없는 간단한 프로그램으로 특정 설치 명령어를 복붙해서 침투시킬 수 있다. 그리고 나면 Caldera 서버랑 연결이 되서 내가 지시하는 내용을 수행하고 그 결과를 다시 Caldera서버에 보내주는 역할을 한다.
Sandcat 외에도 Manx랑 Ragdoll도 있는데 Sandcat이 기본적인 에이전트라고 하니까 그냥 이걸로 썼다.
그래서 해당 사진을 보면 밑에 플랫폼을 선택 할 수 있는 카테고리가 있고 그에 맞는 침투 커맨드가 적혀 있다. 저 명령어를 복붙하면 PID 가 부여되면서 메모리에 상주하게 된다.

![PID](/img/2_4.PNG)

이런 모습으로 보이게 된다.
이렇게 뜨면 해당 호스트에 에이전트를 침투시킨 것이다.
그럼 그 다음 adversaries로 넘어가면 된다.

![adv](/img/2_5.PNG)
오른쪽 상단에 있는 + add ability를 누르면 여기 1번부터 18번 까지 있는 능력을 더 추가 할 수 있다. 간단하게 해석을 해 보자면 Find files의 설명을 보면 '민감한 것으로 간주되는 파일 찾기', Find user processes의 설명을 보면 '사용자로 실행되는 프로세스에 대한 정보 가져오기' 이런 식으로 각종 목적에 따른 공격 종류를 선택 할 수 있다.
이렇게 18가지의 능력으로 무장한(?) 에이전트를 이제 실행 할 준비가 되었다.
